---
- name: install ansible and dependencies
  become: true
  community.general.pacman:
    name:
      - ansible
      - git
      - pyalpm

- name: install custom fact dependencies are installed
  become: true
  community.general.pacman:
    name: python-py-cpuinfo

- name: ensure custom facts directory
  become: true
  ansible.builtin.file:
    path: /etc/ansible/facts.d
    owner: root
    group: root
    mode: 0755
    state: directory

- name: copy custom cpuinfo fact
  become: true
  ansible.builtin.copy:
    dest: /etc/ansible/facts.d/cpuinfo.fact
    owner: root
    group: root
    mode: 0755
    src: cpuinfo.fact
