---
- name: Adding the Grafana APT signing key
  ansible.builtin.apt_key:
    keyring: /usr/share/keyrings/grafana-archive-keyring.gpg
    url: https://apt.grafana.com/gpg.key

- name: Adding the Grafana repository
  ansible.builtin.apt_repository:
    filename: grafana
    repo: >-
      deb [signed-by=/usr/share/keyrings/grafana-archive-keyring.gpg]
      https://apt.grafana.com stable main
    update_cache: true

- name: Installing grafana-agent
  ansible.builtin.apt:
    name: grafana-agent
    state: present
